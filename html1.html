<!DOCTYPE html>
<meta charset="utf-8">
<head>

<style>

    body {
        font: 10px sans-serif;
    }

    .axis path,
    .axis line {
        fill: none;
        stroke: #000;
        shape-rendering: crispEdges;
    }

</style>
</head>
<body>
<div id="plot"></div>
<script src="//d3js.org/d3.v3.min.js"></script>
<script>
    var margin = {top: 20, right: 20, bottom: 30, left: 40},
            width = 960 - margin.left - margin.right,
            height = 500 - margin.top - margin.bottom;
    // setup x
    var xLabel = "R";
    var xValue = function(d) { return d[xLabel];}, // data -> value
            xScale = d3.scale.linear().range([0, width]), // value -> display
            xMap = function(d) { return xScale(xValue(d));}, // data -> display
            xAxis = d3.svg.axis().scale(xScale).orient("bottom");

    // setup y
    var yLabel = "pR";
    var yValue = function(d) { return d[yLabel];}, // data -> value
            yScale = d3.scale.linear().range([height, 0]), // value -> display
            yMap = function(d) { return yScale(yValue(d));}, // data -> display
            yAxis = d3.svg.axis().scale(yScale).orient("left");

    // setup fill color
    var cValue = function(d) { return d.POResCode;},
            color = d3.scale.category10();



    // add the graph canvas to the body of the webpage
//    var svg = d3.select("#plot").append("svg")
//            .attr("width", width + margin.left + margin.right)
//            .attr("height", height + margin.top + margin.bottom)
 //           .append("g")
   //         .attr("transform", "translate(" + margin.left + "," + margin.top + ")");

    // add the tooltip area to the webpage
//    var tooltip = d3.select("#plot").append("div")
  //          .attr("class", "tooltip")
    //        .style("opacity", 0);

    var x = d3.scale.linear()
            .range([0, width]);

    var y = d3.scale.linear()
            .range([height, 0]);

    var svg = d3.select("body").append("svg")
            .attr("width", width + margin.left + margin.right)
            .attr("height", height + margin.top + margin.bottom)
            .append("g")
            .attr("transform", "translate(" + margin.left + "," + margin.top + ")");

    var g_data;

    d3.csv("BaseballData.csv", function(error, data) {
        if (error) throw error;

        data.forEach(function(d) {
            d.PayKey= +d.PayKey;
            d.Year= +d.Year;
            d.Payroll= +d.Payroll;
            d.Abbrev= +d.Abbrev;
            d.PORes= +d.PORes;
            d.POResCode= +d.POResCode;
            d.RegSeasonW= +d.RegSeasonW;
            d.Batters= +d.Batters;
            d.BatAge= +d.BatAge;
            d.RperG= +d.RperG;
            d.PA= +d.PA;
            d.AB= +d.AB;
            d.R= +d.R;
            d.H= +d.H;
            d._2B= +d._2B;
            d._3B= +d._3B;
            d.HR= +d.HR;
            d.RBI= +d.RBI;
            d.SB= +d.SB;
            d.CS= +d.CS;
            d.BB= +d.BB;
            d.SO= +d.SO;
            d.BA= +d.BA;
            d.OBP= +d.OBP;
            d.SLG= +d.SLG;
            d.OPS= +d.OPS;
            d.OPSplus= +d.OPSplus;
            d.TB= +d.TB;
            d.GDP= +d.GDP;
            d.HBP= +d.HBP;
            d.SH= +d.SH;
            d.SF= +d.SF;
            d.IBB= +d.IBB;
            d.LOB= +d.LOB;
            d.PitchersUsed= +d.PitchersUsed;
            d.PAge= +d.PAge;
            d.RunsAgperG= +d.RunsAgperG;
            d.ERA= +d.ERA;
            d.pCG= +d.pCG;
            d.pSho= +d.pSho;
            d.cSho= +d.cSho;
            d.SV= +d.SV;
            d.IP= +d.IP;
            d.pH= +d.pH;
            d.pR= +d.pR;
            d.pER= +d.pER;
            d.pHR= +d.pHR;
            d.pBB= +d.pBB;
            d.pIBB= +d.pIBB;
            d.pSO= +d.pSO;
            d.pHBP= +d.pHBP;
            d.pBK= +d.pBK;
            d.pWP= +d.pWP;
            d.pBF= +d.pBF;
            d.pERA_= +d.pERA_;
            d.pFIP= +d.pFIP;
            d.pWHIP= +d.pWHIP;
            d.pH9= +d.pH9;
            d.pHR9= +d.pHR9;
            d.pBB9= +d.pBB9;
            d.pSO9= +d.pSO9;
            d.pKWratio= +d.pKWratio;
            d.pLOB= +d.pLOB;

            g_data= data;}
        );

        x.domain(d3.extent(data, function(d) { return d.R; })).nice();
        y.domain(d3.extent(data, function(d) { return d.pR; })).nice();

         svg.append("g")
                .attr("class", "x axis")
                .attr("transform", "translate(0," + height + ")")
                .call(xAxis)
                .append("text")
                .attr("class", "label")
                .attr("x", width)
                .attr("y", -6)
                .style("text-anchor", "end")
                .text(xLabel);



        svg.append("g")
                .attr("class", "y axis")
                .call(yAxis)
                .append("text")
                .attr("class", "label")
                .attr("transform", "rotate(-90)")
                .attr("y", 6)
                .attr("dy", ".71em")
                .style("text-anchor", "end")
                .text(yLabel);

        svg.selectAll(".dot")
                .data(data)
                .enter().append("circle")
                .attr("class", "dot")
                .attr("cx", function(d) { return x(d.R); })
                .attr("cy", function(d) { return y(d.pR); })
               // .style("fill", function(d) { return color})
               // .attr("r", function(d){return (d.Payroll/10000000)})
              //  .attr("stroke","black")
             //   .attr("stroke-width", "2"); });


        var legend = svg.selectAll(".legend")
                .data(color.domain())
                .enter().append("g")
                .attr("class", "legend")
                .attr("transform", function(d, i) { return "translate(0," + i * 20 + ")"; });


        legend.append("rect")
                .attr("x", width - 18)
                .attr("width", 18)
                .attr("height", 18)
                .style("fill", "blue");

        legend.append("text")
                .attr("x", width - 24)
                .attr("y", 9)
                .attr("dy", ".35em")
                .style("text-anchor", "end");
                //.text(function(d) { return d.POResCode; });

    });

</script>

<br>

X-Axis:
<select onchange="changeXAxis(this.value);">
    <option value="R" selected>Runs Scored</option>
    <option value="pR" >Runs Against</option>
    <option value="SO" >Strikeouts-Batting</option>
    <option value="pSO" >Strikeouts-Pitching</option>
</select>
Y-Axis:
<select onchange="changeYAxis();" id="yAxisMenu">
    <option value="R" >Runs Scored</option>
    <option value="pR" selected>Runs Against</option>
    <option value="SO" >Strikeouts-Batting</option>
    <option value="pSO" >Strikeouts-Pitching</option>
</select>

<br>

<script>
    function changeXAxis(elem) {
        console.log(elem);
        console.log("Color is "+ color);
        // d3.select("#xlabel").text(elem);
        xLabel = elem;
        xScale.domain([d3.min(g_data, xValue) - 1, d3.max(g_data, xValue) + 1]);
        svg.selectAll(".x.axis")
                .call(xAxis).select(".label").text(xLabel);
        changePos();
    }

    function changeYAxis(){
        var a = document.getElementById("yAxisMenu").value;
        console.log(a);
        yLabel = a;
        // d3.select("#ylabel").text(x);
        yScale.domain([d3.min(g_data, yValue)-1, d3.max(g_data, yValue)+1]);
        svg.selectAll(".y.axis")
                .call(yAxis).select(".label").text(yLabel);
        changePos();
    }
    function changePos(){
        svg.selectAll("circle")
                .transition()
                .duration(500)
                .attr("cx", xMap)
                .attr("cy", yMap)
                .attr("r", function(d){return (d.Payroll/10000000)})
                .attr("stroke","black")
                .attr("stroke-width", "2")
                .attr("fill","red");
    }

</script>

<br>




</body>